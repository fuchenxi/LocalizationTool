# iOS 多语言管理工具

一个基于 PyQt6 的 iOS 项目多语言管理工具，用于简化多语言文件的导入和管理。

> 💡 采用 MVC 架构设计，代码结构清晰，易于维护和扩展。
> 📚 完整文档请查看 [docs/](docs/) 目录 | ⭐ [完整功能总结](docs/FINAL_SUMMARY.md)

## 功能特性

### 1. 项目信息展示
- 自动提取并展示 App 图标
- 显示 App 名称
- 显示版本号
- 显示 Bundle ID

### 2. 一键查重
- 扫描项目中所有 `.lproj` 文件夹下的 `Localizable.strings` 文件
- 按语言分 Tab 显示重复项详情（Key、Value、行号、出现次数、操作）
- **⭐ 交互操作** 🎯
  - **双击 Key/Value/行号** → 📋 复制内容到剪贴板
  - **点击"📂 打开"按钮** → 在 Xcode/VSCode 等编辑器中打开文件并跳转到对应行
  - 鼠标悬停在"打开"按钮上显示手型光标
- 删除重复的 key-value 对，只保留最后一个
- **保留所有注释和空行**，Git diff 只显示删除的行
- 显示删除的重复项数量

### 3. 多语言导入
- 支持从下载的 zip 包导入多语言文件
- **智能 ZIP 列表** - 自动扫描文件夹，列出所有 ZIP 文件
- **按时间排序** - 最新的文件在最上面，默认选中
- **文件信息** - 显示文件名、大小、修改时间
- 自动识别 zip 包中的语言文件（如 `en.strings`, `it.strings` 等）
- 将新增内容追加到项目对应语言文件的末尾
- 使用版本号注释包裹新增内容

### 4. 字符串替换 ⭐ 新功能
- **自动查找硬编码字符串** - 根据提供的 Key 列表扫描代码
- **智能替换** - 将硬编码的 Value 替换为多语言 Key
- **支持 OC 和 Swift** - 自动识别文件类型
- **预览结果** - 替换前显示所有匹配项
- **Git 友好** - 替换示例：
  ```objc
  // 替换前
  @"取消"
  
  // 替换后
  @"action_cancel"
  ```

## 安装依赖

```bash
pip install -r requirements.txt
```

## 使用方法

### 启动程序

```bash
python main.py
```

或者给文件添加执行权限后直接运行：

```bash
chmod +x main.py
./main.py
```

### 操作步骤

1. **选择项目路径**
   - 点击"浏览"按钮
   - 选择你的 iOS 项目根目录
   - 程序会自动提取并显示项目信息

2. **查重（可选）**
   - 点击"开始扫描重复项"按钮
   - 查看扫描结果：按语言分 Tab 显示所有重复项
   - **检查重复项**（可选）：
     - 双击 Key/Value/行号可复制内容
     - 点击"📂 打开"按钮可在编辑器中查看该行的上下文
   - 点击"确认删除重复项"按钮
   - 确认操作后，程序会删除重复项（保留每个 key 的最后一次出现）
   - 所有注释和空行都会保留，Git diff 只显示删除的行
   - 操作日志会显示详细的处理结果

3. **导入多语言**
   - 切换到"导入多语言" Tab
   - 自动列出 Downloads 文件夹中的所有 ZIP 文件（最新的已选中）
   - 可选：点击"更改"选择其他文件夹，点击"刷新"更新列表
   - 在列表中选择要导入的 ZIP 文件
   - 点击"开始导入多语言"按钮
   - 确认后程序会自动完成导入

4. **字符串替换（国际化）** ⭐
   - 切换到"字符串替换" Tab
   - 粘贴需要处理的 Key 列表（每行一个）
   - 选择要扫描的文件类型（OC / Swift）
   - 点击"开始扫描"
   - 查看扫描结果：文件、行号、原字符串、替换为的 Key
   - 确认无误后，点击"确认替换"
   - 在 Xcode 中查看 Git diff 验证修改

## 支持的 zip 包格式

### 格式一：单语言
```
stringsdownload_20251029181000.zip
└── en.strings
```

解压后直接在 Downloads 目录下：
```
/Users/zjs/Downloads/en.strings
```

### 格式二：多语言
```
stringsdownload_20251029182336.zip
└── stringsdownload_20251029182336/
    ├── en.strings
    ├── it.strings
    ├── zh-Hans.strings
    └── ...
```

解压后：
```
/Users/zjs/Downloads/stringsdownload_20251029182336/
├── en.strings
├── it.strings
└── ...
```

## 注意事项

1. **项目结构要求**
   - 项目需要包含 `Info.plist` 文件（用于提取版本号和 App 信息）
   - 语言文件需要在 `.lproj` 文件夹中（如 `en.lproj`, `zh-Hans.lproj`）
   - 每个 `.lproj` 文件夹中需要有 `Localizable.strings` 文件

2. **备份建议**
   - 建议在使用查重功能前先备份项目
   - 或者使用版本控制系统（Git）管理项目

3. **语言代码匹配**
   - zip 包中的文件名（如 `en.strings`）会与项目中的 `.lproj` 文件夹（如 `en.lproj`）进行匹配
   - 如果 zip 包中的语言在项目中不存在，会跳过该语言

## 系统要求

- Python 3.7+
- PyQt6
- macOS / Linux / Windows

## 📚 完整文档

所有文档已按类型整理到 `docs/` 目录：

- **[架构设计](docs/architecture/)** - 代码架构、快速入门、重构总结
- **[功能特性](docs/features/)** - 功能详解、UI 设计、配置字段
- **[使用指南](docs/guides/)** - 交互操作、Xcode 集成、Toast 提示

查看 **[docs/README.md](docs/README.md)** 获取完整文档索引。

## 许可证

MIT License

